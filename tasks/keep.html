<html>
	<head>
		<script src="/an.js" type="text/javascript"></script>
		<title>Task</title>
	</head>
	<body onload=U()>
		<h1>每日任务</h1>
		<textarea type="text" id="todo" rows="6" cols="50" disabled></textarea>
		<button onclick=X() id="Xi" style="width:50px;height:35px">编辑</button>
		<button onclick=E() id="Ei" style="width:50px;height:35px;display:none">完成</button>
		<br><br>
		<button onclick=D() id="Di" style="width:160px;height:35px">完成</button>&emsp;&emsp;&emsp;&emsp;
		<button onclick=C() style="width:50px;height:35px">清空</button>
		<ul id="done"></ul>
	</body>
	<script>
		var r,w;
		function U()
		{
			if (localStorage.keptodo==undefined)
			{localStorage.keptodo="";}
			document.getElementById("todo").value=localStorage.keptodo;
			var u=localStorage.kepdata,v="",g,Al="";
			if (u==undefined)
			{
				localStorage.kepdata="";
				u="";
			}
			for (var i=0;i<u.length;i++)
			{
				if (u[i]=="$")
				{
					Al="<li><span style=\"color:blue\">"+v+"</span><span style=\"color:green\"> 已完成√</li>"+Al;
					g=v;v="";
				}
				else
				{v+=u[i];}
			}
			document.getElementById("done").innerHTML=Al+"<li><strong>加油吧!</strong></li>";
			var date=new Date();
			w=String(date.getFullYear())+"."+String(date.getMonth()+1)+"."+String(date.getDate());
			if (g==w)
			{document.getElementById("Di").disabled=true;document.getElementById("Di").innerText="已完成";}
		}
		function X()
		{
			document.getElementById("todo").disabled=false;
			document.getElementById("Xi").style.display="none";
			document.getElementById("Ei").style.display="inline";
		}
		function E()
		{
			document.getElementById("todo").disabled=true;
			localStorage.keptodo=document.getElementById("todo").value;
			document.getElementById("Xi").style.display="inline";
			document.getElementById("Ei").style.display="none";
		}
		function D()
		{
			r=confirm("确定完成?");
			if (!r)
			{return;}
			document.getElementById("Di").disabled=true;
			localStorage.kepdata+=w+"$";
			alert("已完成！继续加油哦~");
			location.reload();
		}
		function C()
		{
			r=confirm("确定清空?(1/3)");
			if (!r)
			{return;}
			r=confirm("确定清空?(2/3)");
			if (!r)
			{return;}
			r=confirm("确定清空?(3/3)");
			if (!r)
			{return;}
			localStorage.keptodo="";
			localStorage.kepdata="";
			location.reload();
		}
	</script>
</html>